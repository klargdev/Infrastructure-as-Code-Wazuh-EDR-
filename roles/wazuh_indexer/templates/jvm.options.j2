# JVM options for Wazuh Indexer - Conservative settings for stability (Java 17+ compatible)
-Xms{{ wazuh_indexer_heap_size | default('256m') }}
-Xmx{{ wazuh_indexer_heap_size | default('256m') }}

# Garbage collection (using G1GC for better performance)
-XX:+UseG1GC
-XX:G1ReservePercent=25
-XX:InitiatingHeapOccupancyPercent=75
-XX:MaxGCPauseMillis=200

# Performance tuning
-XX:+DisableExplicitGC
-XX:+AlwaysPreTouch
-server
-Djava.awt.headless=true
-Dfile.encoding=UTF-8
-Djna.nosys=true

# Security
-Dlog4j2.formatMsgNoLookups=true
-Dlog4j2.disable.jmx=true

# Network settings
-Dio.netty.allocator.type=pooled
-Dio.netty.allocator.numDirectArenas=0

# Error handling and debugging - Java 17+ compatible options only
-XX:+PrintGCDetails
-Xloggc:/var/log/wazuh-indexer/gc.log
#-XX:+UseGCLogFileRotation
#-XX:NumberOfGCLogFiles=5
#-XX:GCLogFileSize=50M

# Memory management - Conservative settings
-XX:+UseStringDeduplication
-XX:MaxMetaspaceSize=256m
-XX:CompressedClassSpaceSize=128m

# System properties for stability
-Djava.security.egd=file:/dev/./urandom
-Dsun.net.http.allowRestrictedHeaders=true
